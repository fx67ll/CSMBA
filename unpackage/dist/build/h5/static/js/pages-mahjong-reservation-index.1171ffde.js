(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-mahjong-reservation-index"],{"0db5":function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * uni-app内置的常用样式变量\r\n */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */uni-page-body[data-v-b1b9e6be]{background-color:#fff}body.?%PAGE?%[data-v-b1b9e6be]{background-color:#fff}\r\n/* 新增：提交按钮容器（固定定位到底部） */.submit-btn-container[data-v-b1b9e6be]{position:fixed;bottom:%?100?%;left:0;right:0;padding:%?20?% %?30?%;box-shadow:0 %?-2?% %?10?% rgba(0,0,0,.05);z-index:99}\r\n/* 新增：提交按钮样式 */.submit-btn[data-v-b1b9e6be]{width:100%;height:%?80?%;line-height:%?80?%;background-color:#2ecc71;color:#fff;font-size:%?32?%;border-radius:%?40?%}\r\n/* 新增：全局遮罩层样式 */.loading-mask[data-v-b1b9e6be]{position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:9999}.loading-content[data-v-b1b9e6be]{background-color:#fff;padding:%?40?% %?60?%;border-radius:%?20?%;display:flex;align-items:center;justify-content:center}.loading-text[data-v-b1b9e6be]{font-size:%?32?%;color:#333}',""]),e.exports=t},"17b7":function(e,t,i){"use strict";i.r(t);var n=i("9bb2"),a=i("e744");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("6dce");var o=i("f0c5"),s=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"6344f7be",null,!1,n["a"],void 0);t["default"]=s.exports},"24bf":function(e,t,i){"use strict";i("7a82");var n=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(i("5530"));i("ac1f"),i("5319"),i("d3b7"),i("4de4"),i("d81d");var r=n(i("17b7")),o=i("4a31"),s=n(i("c161"));i("9555");var c=n(i("2b55")),l={components:{prettyTimes:r.default},data:function(){return{appointConfig:{showOvernight:!0,allowBeginTime:"10:00:00",allowEndTime:"22:00:00",allowTimeInterval:1,appointTime:["2022-02-10 15:30:00"],disableTimeSlot:[],myAppointTimeSlot:[]},logList:[],queryParams:{pageNum:1,pageSize:999,mahjongRoomId:1,reservationDate:"",reservationStatus:"",isNeedAll:!0},formParams:{mahjongRoomId:1,reservationStartTime:null,reservationEndTime:null,reservationStatus:null},nowDateInfo:{},isOvernightSelected:!1,debouncedSubmitReservation:null,loading:!1}},onShow:function(){this.handleDateChange(this.nowDateInfo)},onLoad:function(){var e=(0,s.default)().format("YYYY-MM-DD"),t=(0,s.default)().format("dddd");this.nowDateInfo={selectedDate:e,selectedWeek:t,activeIndex:0},this.queryParams.reservationDate=e.replace(/-/g,""),this.queryParams.pageNum=1,this.queryParams.pageSize=999,this.queryLogList(!0),this.queryLogList(!1),this.debouncedSubmitReservation=c.default.debounce(this._realHandleSubmitReservation,500,!0)},methods:{handleComponentReady:function(){var e,t,i,n=(null===this||void 0===this||null===(e=this.$refs)||void 0===e||null===(t=e.prettyTimes)||void 0===t||null===(i=t.dateArr)||void 0===i?void 0:i[0])||null;n&&(this.nowDateInfo={selectedDate:n.date,selectedWeek:n.week,activeIndex:0})},clearLogList:function(){this.logList=[],this.appointConfig.disableTimeSlot=[],this.appointConfig.myAppointTimeSlot=[]},queryLogList:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=this;this.loading=!0,this.queryParams.pageNum=1,this.queryParams.pageSize=999,this.queryParams.isNeedAll=t,(0,o.listMahjongReservationLog)(i.queryParams).then((function(n){var a;if(200===(null===n||void 0===n?void 0:n.code))if(null!==n&&void 0!==n&&n.rows&&(null===n||void 0===n||null===(a=n.rows)||void 0===a?void 0:a.length)>0){var r,o;i.logList=(null===n||void 0===n?void 0:n.rows)||[];var c=(null===(r=(null===n||void 0===n?void 0:n.rows)||[])||void 0===r||null===(o=r.filter((function(e){return"0"===e.reservationStatus})))||void 0===o?void 0:o.map((function(e){var t=(0,s.default)(e.reservationStartTime).format("YYYY-MM-DD HH:mm:ss"),i=(0,s.default)(e.reservationEndTime),n=(0,s.default)();return i.isAfter(n.subtract(1,"hours"))&&(i=i.subtract(1,"hours")),[t,i.format("YYYY-MM-DD HH:mm:ss")]})))||[];t?e.appointConfig.disableTimeSlot=c:e.appointConfig.myAppointTimeSlot=c}else i.clearLogList();else i.clearLogList(),uni.showToast({title:"查询预约订单记录失败！",icon:"none",duration:1998})})).catch((function(e){i.clearLogList()})).finally((function(){e.loading=!1}))},handleOvernightChange:function(e){e?(this.isOvernightSelected=!0,this.formParams.reservationStartTime=e.start,this.formParams.reservationEndTime=(0,s.default)(e.end).subtract(1,"h").format("YYYY-MM-DD HH:mm:ss")):(this.isOvernightSelected=!1,this.formParams.reservationStartTime=null,this.formParams.reservationEndTime=null)},handleOvernightSubmit:function(e){e&&(this.formParams.reservationStartTime=e.start,this.formParams.reservationEndTime=e.end,this.submitReservation())},handleTimeChange:function(e){this.isOvernightSelected=!1;var t=(null===e||void 0===e?void 0:e.beginTime)||"",i=(null===e||void 0===e?void 0:e.endTime)||"";this.formParams=(0,a.default)((0,a.default)({},this.formParams),{},{reservationStartTime:t,reservationEndTime:i})},handleDateChange:function(e){var t;this.nowDateInfo=e;var i=(null===e||void 0===e||null===(t=e.selectedDate)||void 0===t?void 0:t.replace(/-/g,""))||"";this.queryParams.isNeedAll=!0,this.queryParams.reservationDate=i,this.queryLogList(!0),this.queryLogList(!1)},handleSubmitReservation:function(){this.debouncedSubmitReservation()},_realHandleSubmitReservation:function(){if(this.isOvernightSelected&&this.formParams.reservationStartTime&&this.formParams.reservationEndTime)this.submitReservation();else{if(this.formParams.mahjongRoomId=1,this.formParams.reservationStatus=0,this.formParams.reservationStartTime&&this.formParams.reservationEndTime){var e=(0,s.default)(this.formParams.reservationStartTime),t=(0,s.default)(this.formParams.reservationEndTime);if(e.isAfter(t)){var i=[this.formParams.reservationEndTime,this.formParams.reservationStartTime];this.formParams.reservationStartTime=i[0],this.formParams.reservationEndTime=i[1]}this.submitReservation()}else uni.showToast({title:"请选择完整的预约时间段！",icon:"none",duration:1998})}},submitReservation:function(){var e=this;this.formParams.reservationEndTime=(0,s.default)(this.formParams.reservationEndTime).add(1,"h").format("YYYY-MM-DD HH:mm:ss"),(0,o.addMahjongReservationLog)(this.formParams).then((function(t){200===(null===t||void 0===t?void 0:t.code)?(e.queryLogList(!0),e.queryLogList(!1),e.formParams.reservationStartTime=null,e.formParams.reservationEndTime=null,e.isOvernightSelected=!1,uni.showToast({title:"提交预约订单成功！",icon:"none",duration:1998})):uni.showToast({title:"提交预约订单失败！",icon:"none",duration:1998})})).catch((function(e){uni.showToast({title:"提交预约订单失败！",icon:"none",duration:1998})}))}}};t.default=l},"34e8":function(e,t,i){"use strict";i.r(t);var n=i("fd18"),a=i("920f");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("7bb3");var o=i("f0c5"),s=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"b1b9e6be",null,!1,n["a"],void 0);t["default"]=s.exports},3850:function(e,t,i){"use strict";function n(e){return e<10?"0".concat(e):e}function a(e,t){var i=new Date(e),a=i.getFullYear(),r=i.getMonth()+1,o=i.getDate(),s=i.getDay(),c=i.getHours(),l=i.getMinutes();return{allDate:"".concat(a,"/").concat(n(r),"/").concat(n(o)),date:"".concat(n(a),"-").concat(n(r),"-").concat(n(o)),day:"星期".concat(["日","一","二","三","四","五","六"][s]),hour:n(c)+":"+n(l)+(t?"":":00")}}i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.currentTime=function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1,a=e.getDate(),r=t+"-"+n(i)+"-"+n(a),o=e.getHours(),s=e.getMinutes(),c=e.getSeconds(),l=n(o)+":"+n(s)+":"+n(c);return{date:r,time:l}},t.initData=function(){for(var e=[],t=new Date,i=t.getTime(),n={0:"今天",1:"明天",2:"后天"},r=0;r<30;r++){var o;e.push({date:a(i+864e5*r).date,timeStamp:i+864e5*r,week:null!==(o=n[r])&&void 0!==o?o:a(i+864e5*r).day})}return e},t.initTime=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"10:00:00",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"21:00:00",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=[],o=a(Date.now()).allDate,s="".concat(o," ").concat(e),c="".concat(o," ").concat(t),l=new Date(s).getTime(),d=new Date(c).getTime(),u=36e5*i,h=(d-l)/u,v=h%2==0?h:h-1,m=0,f=l;f<=d;f+=u)if(n?(m++,r.push({begin:a(f,n).hour,end:a(f+u,n).hour,disable:!1})):r.push({time:a(f).hour,disable:!1}),n&&m>=v)return r;return r},t.timeStamp=a,i("99af"),i("14d9")},"4a31":function(e,t,i){"use strict";i("7a82");var n=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.addMahjongReservationLog=function(e){return(0,a.default)({url:"/mahjong/reservation/log/addReservationLogForApp",method:"post",data:e})},t.editMahjongReservationLog=function(e){return(0,a.default)({url:"/mahjong/reservation/log/editReservationLogForApp",method:"put",data:e})},t.listMahjongReservationLog=function(e){var t=e.pageNum,i=e.pageSize;return delete e.pageNum,delete e.pageSize,(0,a.default)({url:"/mahjong/reservation/log/getReservationLogListForApp?pageNum=".concat(t,"&pageSize=").concat(i),method:"post",data:e})},i("99af");var a=n(i("5912"))},5792:function(e,t,i){var n=i("6b68");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("02299163",n,!0,{sourceMap:!1,shadowMode:!1})},6425:function(e,t,i){"use strict";i("7a82");var n=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(i("53ca")),r=n(i("3835")),o=n(i("b85c"));i("a9e3"),i("fb6a"),i("d3b7"),i("159b"),i("99af"),i("caad"),i("2532"),i("13d5"),i("14d9");var s=i("3850"),c={name:"prettyTimes",model:{prop:"showPop",event:"change"},props:{isQuantum:{type:Boolean,default:!1},isMultiple:{type:Boolean,default:!1},isSection:{type:Boolean,default:!1},showOvernight:{type:Boolean,default:!1},disableText:{type:String,default:"已约满"},undisableText:{type:String,default:"可预约"},timeInterval:{type:Number,default:1},selectedTabColor:{type:String,default:"#2ecc71"},selectedItemColor:{type:String,default:"#2ecc71"},beginTime:{type:String,default:"09:00:00"},endTime:{type:String,default:"19:00:00"},appointTime:{type:Array,default:function(){return[]}},disableTimeSlot:{type:Array,default:function(){return[]}},myAppointTimeSlot:{type:Array,default:function(){return[]}},formParams:{type:Object,default:function(){return{}}}},watch:{appointTime:{handler:function(e){this.initOnload()}},disableTimeSlot:{handler:function(e){this.initOnload()}},myAppointTimeSlot:{handler:function(e){this.initOnload()}},formParams:{handler:function(e){this.checkOvernightEcho(),this.checkTimeSectionEcho()},deep:!0}},data:function(){return{orderDateTime:"暂无选择",orderTimeArr:{},dateArr:[],timeArr:[],nowDate:"",dateActive:0,timeActive:0,timeQuanBeginIndex:0,selectDate:"",timeQuanBegin:"",timeQuanEnd:"",isOvernightActive:!1,isOvernightDisabled:!1,isOvernightExpired:!1,isOvernightMyAppoint:!1}},created:function(e){this.selectDate=this.nowDate=(0,s.currentTime)().date,this.initOnload()},mounted:function(){this.$emit("ready")},methods:{initOnload:function(){var e=this;this.dateArr=(0,s.initData)(),this.timeArr=(0,s.initTime)(this.beginTime,this.endTime,this.timeInterval,this.isQuantum),this.timeQuanBegin=this.timeQuanEnd="";var t=!0,i=(0,s.currentTime)().time,n=new Date("2000-01-01 ".concat(i)).getTime(),a=n+36e5,c=new Date(a).toTimeString().slice(0,8);this.isSection&&!this.isQuantum?this.timeArr.forEach((function(t,i){var n=t.time,a=n.slice(0,5),r=new Date("2000-01-01 ".concat(n)).getTime(),o=r+36e5*e.timeInterval,s=new Date(o).toTimeString().slice(0,5);t.timeRange="".concat(a,"~").concat(s)})):this.isQuantum||this.timeArr.forEach((function(t,i){var n=t.time,a=n.slice(0,5),r=new Date("2000-01-01 ".concat(n)).getTime(),o=r+36e5*e.timeInterval,s=new Date(o).toTimeString().slice(0,5);t.timeRange="".concat(a,"~").concat(s)})),this.checkOvernightStatus(),this.checkTimeSectionEcho(),this.timeArr.forEach((function(i,n){if(i.isMyAppoint=!1,i.isExpired=!1,e.isQuantum){var a,s="".concat(e.selectDate," ").concat(i.begin,":00"),l="".concat(e.selectDate," ").concat(i.end,":00"),d=(0,o.default)(e.myAppointTimeSlot);try{for(d.s();!(a=d.n()).done;){var u=a.value,h=(0,r.default)(u,2),v=h[0],m=void 0===v?"":v,f=h[1],g=void 0===f?"":f;m&&g&&m<=s&&l<=g&&(i.isMyAppoint=!0,i.disable=!1)}}catch(F){d.e(F)}finally{d.f()}if(!i.isMyAppoint){var b,p=(0,o.default)(e.disableTimeSlot);try{for(p.s();!(b=p.n()).done;){var T=b.value,y=(0,r.default)(T,2),x=y[0],A=void 0===x?"":x,w=y[1],D=void 0===w?"":w;A&&D&&A<=s&&l<=D&&(i.disable=!0)}}catch(F){p.e(F)}finally{p.f()}e.selectDate==e.nowDate&&c>"".concat(i.begin,":00")&&(i.disable=!0,i.isExpired=!0)}if(e.orderTimeArr[e.selectDate]){var S,E=(0,o.default)(e.orderTimeArr[e.selectDate]);try{for(E.s();!(S=E.n()).done;){var O=S.value;O[0].split(" ")[1]==="".concat(i.begin,":00")&&O[1].split(" ")[1]==="".concat(i.end,":00")&&(i.isActive=!0)}}catch(F){E.e(F)}finally{E.f()}}}else{var M,C="".concat(e.selectDate," ").concat(i.time),P=(0,o.default)(e.myAppointTimeSlot);try{for(P.s();!(M=P.n()).done;){var _=M.value,Q=(0,r.default)(_,2),k=Q[0],I=void 0===k?"":k,L=Q[1],$=void 0===L?"":L;I&&$&&I<=C&&C<=$&&(i.isMyAppoint=!0,i.disable=!1)}}catch(F){P.e(F)}finally{P.f()}if(!i.isMyAppoint){e.appointTime.forEach((function(t){var n=t.split(" "),a=(0,r.default)(n,2),o=a[0],s=a[1];o==e.selectDate&&i.time==s&&(i.disable=!0)}));var R,j=(0,o.default)(e.disableTimeSlot);try{for(j.s();!(R=j.n()).done;){var B=R.value,Y=(0,r.default)(B,2),z=Y[0],q=void 0===z?"":z,N=Y[1],H=void 0===N?"":N;q&&H&&q<=C&&C<=H&&(i.disable=!0)}}catch(F){j.e(F)}finally{j.f()}e.selectDate==e.nowDate&&c>i.time&&(i.disable=!0,i.isExpired=!0)}i.disable||i.isMyAppoint||(t=!1),e.isSection&&(e.formParams.reservationStartTime&&e.formParams.reservationEndTime||(i.isInclude=!1)),e.isMultiple&&(e.orderTimeArr[e.selectDate]||[]).includes(i.time)&&(i.isActive=!0)}})),this.orderDateTime=t?"暂无选择":this.selectDate,this.timeActive=-1;for(var l=0,d=this.timeArr.length;l<d;l++)if(!this.timeArr[l].disable&&!this.timeArr[l].isMyAppoint){var u=this.timeArr[l].time.slice(0,5);return this.orderDateTime="".concat(this.selectDate," ").concat(u),void(this.timeActive=l)}},checkTimeSectionEcho:function(){if(this.isSection&&this.formParams.reservationStartTime&&this.formParams.reservationEndTime){var e=this.formParams.reservationStartTime,t=this.formParams.reservationEndTime,i=e.split(" ")[0];if(i===this.selectDate){var n=e.split(" ")[1].slice(0,5),a=t.split(" ")[1].slice(0,5),r=-1,o=-1;if(this.timeArr.forEach((function(e,t){var i=e.time.slice(0,5);i===n&&(r=t),i===a&&(o=t)})),-1!==r&&-1!==o){this.timeQuanBeginIndex=r,this.timeQuanBegin=this.timeArr[r].time,this.timeQuanEnd=this.timeArr[o].time;for(var s=r+1;s<o;s++)this.timeArr[s].isInclude=!0;this.orderDateTime="".concat(this.selectDate," ").concat(n," ~ ").concat(a)}}}},getOvernightStatusText:function(){return this.isOvernightExpired?"已过期":this.isOvernightMyAppoint?"我已约":this.isOvernightDisabled?"已约满":"可预约"},checkOvernightStatus:function(){if(this.isOvernightActive=!1,this.isOvernightDisabled=!1,this.isOvernightExpired=!1,this.isOvernightMyAppoint=!1,this.showOvernight){var e="".concat(this.selectDate," 23:00:00"),t=this.getNextDate(this.selectDate),i="".concat(t," 09:00:00");if(this.selectDate===this.nowDate){var n=new Date,a=new Date("".concat(this.selectDate," 23:00:00"));n>=a&&(this.isOvernightExpired=!0,this.isOvernightDisabled=!0)}var s,c=(0,o.default)(this.myAppointTimeSlot);try{for(c.s();!(s=c.n()).done;){var l=s.value,d=(0,r.default)(l,2),u=d[0],h=void 0===u?"":u,v=d[1],m=void 0===v?"":v;if(h&&m&&h===e&&m===i){this.isOvernightMyAppoint=!0,this.isOvernightDisabled=!0;break}}}catch(w){c.e(w)}finally{c.f()}if(!this.isOvernightMyAppoint&&!this.isOvernightExpired){var f,g=(0,o.default)(this.disableTimeSlot);try{for(g.s();!(f=g.n()).done;){var b=f.value,p=(0,r.default)(b,2),T=p[0],y=void 0===T?"":T,x=p[1],A=void 0===x?"":x;if(y&&A&&(y<=e&&e<A||y<i&&i<=A||e<=y&&A<=i)){this.isOvernightDisabled=!0;break}}}catch(w){g.e(w)}finally{g.f()}}this.checkOvernightEcho()}},checkOvernightEcho:function(){if(this.showOvernight){var e="".concat(this.selectDate," 23:00:00"),t=this.getNextDate(this.selectDate),i="".concat(t," 10:00:00");if(this.formParams&&this.formParams.reservationStartTime&&this.formParams.reservationEndTime){var n=this.formParams.reservationStartTime,a=this.formParams.reservationEndTime;n===e&&a===i?(this.isOvernightActive=!0,this.orderDateTime="".concat(this.selectDate," 23:00 ~ ").concat(t," 10:00")):this.isOvernightActive=!1}}},getNextDate:function(e){var t=new Date(e);return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]},selectOvernightEvent:function(){if(!this.isOvernightDisabled)if(this.isOvernightActive=!this.isOvernightActive,this.isOvernightActive){this.clearTimeSelection();var e="".concat(this.selectDate," 23:00:00"),t=this.getNextDate(this.selectDate),i="".concat(t," 10:00:00");this.$emit("overnight-change",{start:e,end:i,date:this.selectDate}),this.orderDateTime="".concat(this.selectDate," 23:00 ~ ").concat(t," 10:00")}else this.$emit("overnight-change",null),this.orderDateTime="暂无选择"},clearTimeSelection:function(){this.timeActive=-1,this.timeQuanBegin="",this.timeQuanEnd="",this.orderDateTime="暂无选择",this.orderTimeArr={},this.timeArr.forEach((function(e){e.isActive=!1,e.isInclude=!1}))},selectDateEvent:function(e,t){this.dateActive=e,this.selectDate=t.date,this.initOnload(),this.$emit("date-change",{selectedDate:t.date,selectedWeek:t.week,activeIndex:e})},selectTimeEvent:function(e,t){var i=this;if(this.isOvernightActive&&(this.isOvernightActive=!1,this.$emit("overnight-change",null)),this.isQuantum)return this.handleSelectQuantum(e,t);if(!t.isMyAppoint&&!t.disable)if(this.isMultiple)(function(){t.isActive=!t.isActive,i.timeArr=i.timeArr.slice(),i.orderTimeArr[i.selectDate]=i.timeArr.reduce((function(e,t){return t.isActive&&e.push(t.time),e}),[]);var e=[],n=function(t){i.orderTimeArr[t].forEach((function(i){e.push("".concat(t," ").concat(i))}))};for(var a in i.orderTimeArr)n(a);i.$emit("change",e)})();else{this.timeActive=e;var n=t.time.slice(0,5);this.orderDateTime="".concat(this.selectDate," ").concat(n),this.$emit("change",this.orderDateTime)}},handleSection:function(e,t){var i=this;if(this.isOvernightActive&&(this.isOvernightActive=!1,this.$emit("overnight-change",null)),!t.isMyAppoint&&!t.disable){var n=function(){i.timeQuanBeginIndex=e,i.timeQuanBegin=t.time,i.timeQuanEnd="",i.$emit("change",{beginTime:"".concat(i.selectDate," ").concat(i.timeQuanBegin),endTime:i.timeQuanEnd?"".concat(i.selectDate," ").concat(i.timeQuanEnd):null})};if(this.timeQuanBegin)if(this.timeQuanEnd||!this.timeQuanBegin)this.timeQuanBegin&&this.timeQuanEnd&&(this.timeArr.forEach((function(e){e.isInclude=!1})),n());else{var a,r=!1,o=this.timeQuanBeginIndex,s=e;o>s&&(a=[s,o],o=a[0],s=a[1]);for(var c=o+1;c<s;c++)if(this.timeArr[c].disable||this.timeArr[c].isMyAppoint)return r=!0,void n();if(!r)for(var l=o+1;l<s;l++)this.timeArr[l].isInclude=!0;this.timeQuanEnd=t.time;var d="".concat(this.selectDate," ").concat(this.timeQuanBegin),u="".concat(this.selectDate," ").concat(this.timeQuanEnd);this.$emit("change",{beginTime:d,endTime:u})}else n()}},handleSelectQuantum:function(e,t){var i=this;this.isOvernightActive&&(this.isOvernightActive=!1,this.$emit("overnight-change",null)),t.isMyAppoint||t.disable||(this.isMultiple?(t.isActive=!t.isActive,this.timeArr=this.timeArr.slice(),this.orderTimeArr[this.selectDate]=this.timeArr.reduce((function(e,t){var n="".concat(i.selectDate," ").concat(t.begin,":00"),a="".concat(i.selectDate," ").concat(t.end,":00");return t.isActive&&e.push([n,a]),e}),[]),this.$emit("change",this.orderTimeArr)):(this.timeActive=e,this.orderDateTime={begin:"".concat(this.selectDate," ").concat(t.begin,":00"),end:"".concat(this.selectDate," ").concat(t.end,":00")},this.$emit("change",this.orderDateTime)))},handleChange:function(){var e;this.timeQuanBegin>this.timeQuanEnd&&(e=[this.timeQuanEnd,this.timeQuanBegin],this.timeQuanBegin=e[0],this.timeQuanEnd=e[1])},handleSubmit:function(){var e=this;if(this.isOvernightActive){var t="".concat(this.selectDate," 23:00:00"),i=this.getNextDate(this.selectDate),n="".concat(i," 10:00:00");this.$emit("overnight-submit",{start:t,end:n,date:this.selectDate})}else if(this.isSection){this.handleChange();var r="".concat(this.selectDate," ").concat(this.timeQuanBegin),o=this.timeQuanEnd?"".concat(this.selectDate," ").concat(this.timeQuanEnd):null;this.$emit("change",{beginTime:r,endTime:o})}else if(this.isMultiple){var s=function(){if(e.isQuantum)return e.$emit("change",e.orderTimeArr),{v:void 0};var t=[],i=function(i){e.orderTimeArr[i].forEach((function(e){t.push("".concat(i," ").concat(e))}))};for(var n in e.orderTimeArr)i(n);e.$emit("change",t)}();if("object"===(0,a.default)(s))return s.v}else this.$emit("change",this.orderDateTime)}}};t.default=c},"6b68":function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * uni-app内置的常用样式变量\r\n */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */uni-page-body[data-v-6344f7be]{height:100%}.content[data-v-6344f7be]{text-align:center;height:100%}.bottom[data-v-6344f7be]{display:flex;flex-direction:row;position:fixed;bottom:8px;top:auto;left:0;width:100%}.show-time[data-v-6344f7be]{width:70%;height:47px;color:#505050;font-size:15px;line-height:47px;text-align:center;background-color:#fff}.submit-btn[data-v-6344f7be]{width:25%;height:40px;color:#fff;background-color:#2ecc71;font-size:15px;line-height:40px;text-align:center;margin:auto;padding:0}.fontw[data-v-6344f7be]{font-weight:700}.borderb[data-v-6344f7be]{border-bottom:2px solid #2ecc71}.container uni-view[data-v-6344f7be],\r\n.container uni-text[data-v-6344f7be],\r\n.container uni-image[data-v-6344f7be]{box-sizing:border-box}.container uni-scroll-view[data-v-6344f7be]{width:100%;white-space:nowrap;height:75px;background-color:#fff;position:relative;padding-top:10px}.container uni-scroll-view[data-v-6344f7be]::after{background:#e5e5e5;content:"";display:block;width:100%;height:1px;position:absolute;bottom:0;left:0;-webkit-transform:scaleY(.5);transform:scaleY(.5)}.container uni-scroll-view .flex-box[data-v-6344f7be]{display:inline-block;height:60px;width:25%;margin:0 %?7?% 0 %?7?%;box-sizing:border-box}.container uni-scroll-view .flex-box.active .date-box[data-v-6344f7be]{border:none}.container uni-scroll-view .flex-box.active .date-box .days[data-v-6344f7be]{font-weight:700;color:#818181}.container uni-scroll-view .flex-box.active .date-box .date[data-v-6344f7be]{font-weight:700;color:#818181}.container uni-scroll-view .flex-box .date-box[data-v-6344f7be]{border:none;display:flex;height:50px;flex-direction:column;align-items:center;justify-content:space-around;font-size:%?30?%;color:#818181}.container uni-scroll-view .flex-box .date-box .date[data-v-6344f7be]{font-weight:700;color:#818181;font-size:%?30?%}.container .time-box[data-v-6344f7be]{padding:%?28?% %?12?% %?26?%;display:flex;flex-wrap:wrap;background-color:#fff;padding-bottom:%?220?%}.container .time-box .item[data-v-6344f7be]{width:25%;padding:0 %?9?%;margin:10px 0}.container .time-box .item-box[data-v-6344f7be]{width:100%;height:%?154?%;padding:0 %?44?%;background:#fff;color:#333;border:1px solid #eee;font-size:%?28?%;border-radius:%?10?%;display:flex;flex-direction:column;align-items:center;justify-content:center}.container .time-box .item-box.disable[data-v-6344f7be]{background:#f1f3f6!important;color:#999!important}.container .time-box .item-box.my-appoint[data-v-6344f7be]{background:rgba(46,204,113,.1)!important;color:#2ecc71!important}.container .time-box .item-box.active[data-v-6344f7be]{border:1px solid #2ecc71;font-weight:700}.container .time-box .item-box .all[data-v-6344f7be]{font-size:%?22?%;padding-top:5px}.overnight-item-wrapper[data-v-6344f7be]{flex:0 0 75%}.overnight-item-wrapper .overnight-box[data-v-6344f7be]{display:flex;flex-direction:column;align-items:center;padding:%?30?% %?20?%;border:%?2?% solid #e0e0e0;border-radius:%?12?%;background-color:#f9f9f9;transition:all .3s ease;height:100%;justify-content:center}.overnight-item-wrapper .overnight-box.active[data-v-6344f7be]{border-color:#2ecc71;background-color:#e8f5e8;color:#2ecc71}.overnight-item-wrapper .overnight-box.disable[data-v-6344f7be]{background-color:#f5f5f5;color:#999;border-color:#ddd}.overnight-item-wrapper .overnight-box .overnight-content[data-v-6344f7be]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center}.overnight-title[data-v-6344f7be]{font-size:%?32?%;font-weight:700;margin-bottom:%?10?%}.overnight-time[data-v-6344f7be]{font-size:%?28?%;margin-bottom:%?10?%}.overnight-status[data-v-6344f7be]{font-size:%?24?%;color:#666}.overnight-box.active .overnight-status[data-v-6344f7be]{color:#2ecc71}.overnight-box.disable .overnight-status[data-v-6344f7be]{color:#999}',""]),e.exports=t},"6dce":function(e,t,i){"use strict";var n=i("5792"),a=i.n(n);a.a},"7bb3":function(e,t,i){"use strict";var n=i("cefc"),a=i.n(n);a.a},"920f":function(e,t,i){"use strict";i.r(t);var n=i("24bf"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t["default"]=a.a},"9bb2":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"container"},[i("v-uni-scroll-view",{staticClass:"scroll-view_H b-t b-b",attrs:{"scroll-x":!0}},[e._l(e.dateArr,(function(t,n){return[i("div",{key:n+"_0",staticClass:"flex-box",class:{borderb:n==e.dateActive},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.selectDateEvent(n,t)}}},[i("v-uni-view",{staticClass:"date-box",style:{color:n==e.dateActive?e.selectedTabColor:"#333"}},[i("v-uni-text",{staticClass:"fontw"},[e._v(e._s(t.week))]),i("v-uni-text",[e._v(e._s(t.date))])],1)],1)]}))],2),!e.isSection||e.isQuantum?i("v-uni-view",{staticClass:"time-box"},[e._l(e.timeArr,(function(t,n){return[i("v-uni-view",{key:n,staticClass:"item"},[i("v-uni-view",{staticClass:"item-box",class:{disable:t.disable&&!t.isMyAppoint,"my-appoint":t.isMyAppoint,active:e.isMultiple?t.isActive:n==e.timeActive},style:{color:t.isMyAppoint?"#2ecc71":e.isMultiple?t.isActive?e.selectedItemColor:"#333":n==e.timeActive?e.selectedItemColor:"#333"},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.selectTimeEvent(n,t)}}},[e.isQuantum?i("v-uni-text",[e._v(e._s(t.begin)+"~"+e._s(t.end))]):i("v-uni-text",[e._v(e._s(t.timeRange))]),i("v-uni-text",{staticClass:"all"},[e._v(e._s(t.isMyAppoint?"我已约":t.isExpired?"已过期":t.disable?e.disableText:e.undisableText))])],1)],1)]}))],2):i("v-uni-view",{staticClass:"time-box"},[e._l(e.timeArr,(function(t,n){return[i("v-uni-view",{key:n,staticClass:"item"},[i("v-uni-view",{staticClass:"item-box",class:{disable:t.disable&&!t.isMyAppoint,"my-appoint":t.isMyAppoint,active:t.time==e.timeQuanBegin||t.time==e.timeQuanEnd||t.isInclude},style:{color:t.isMyAppoint?"#2ecc71":t.time==e.timeQuanBegin||t.time==e.timeQuanEnd||t.isInclude?e.selectedItemColor:"#333"},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.handleSection(n,t)}}},[i("v-uni-text",[e._v(e._s(t.timeRange))]),i("v-uni-text",{staticClass:"all"},[e._v(e._s(t.isMyAppoint?"我已约":t.isExpired?"已过期":t.disable?e.disableText:e.undisableText))])],1)],1)]})),e.showOvernight?i("v-uni-view",{staticClass:"item overnight-item-wrapper"},[i("v-uni-view",{staticClass:"item-box overnight-box",class:{active:e.isOvernightActive,disable:e.isOvernightDisabled},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.selectOvernightEvent.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"overnight-content"},[i("v-uni-text",{staticClass:"overnight-title"},[e._v("包夜")]),i("v-uni-text",{staticClass:"overnight-time"},[e._v("23:00 ~ 次日10:00")]),i("v-uni-text",{staticClass:"overnight-status"},[e._v(e._s(e.getOvernightStatusText()))])],1)],1)],1):e._e()],2)],1),i("v-uni-view",{staticClass:"bottom"},[e.isMultiple||e.isSection||e.isQuantum?e._e():i("v-uni-view",{staticClass:"show-time"},[e._v("预约时间："+e._s(e.orderDateTime))]),i("v-uni-button",{staticClass:"submit-btn",attrs:{"form-type":"submit",type:"default",size:"mini"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSubmit.apply(void 0,arguments)}}},[e._v("确认预约")])],1)],1)},a=[]},b85c:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=(0,n.default)(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==i["return"]||i["return"]()}finally{if(c)throw o}}}},i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0"),i("d9e2"),i("d401");var n=function(e){return e&&e.__esModule?e:{default:e}}(i("06c5"))},cefc:function(e,t,i){var n=i("0db5");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("47158f2a",n,!0,{sourceMap:!1,shadowMode:!1})},e744:function(e,t,i){"use strict";i.r(t);var n=i("6425"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t["default"]=a.a},fd18:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"fx67ll-reservation-box"},[e.loading?i("v-uni-view",{staticClass:"loading-mask"},[i("v-uni-view",{staticClass:"loading-content"},[i("v-uni-text",{staticClass:"loading-text"},[e._v("加载数据中...")])],1)],1):e._e(),i("prettyTimes",{ref:"prettyTimes",attrs:{showOvernight:e.appointConfig.showOvernight,beginTime:e.appointConfig.allowBeginTime,endTime:e.appointConfig.allowEndTime,timeInterval:e.appointConfig.allowTimeInterval,appointTime:e.appointConfig.appointTime,isSection:!0,disableTimeSlot:e.appointConfig.disableTimeSlot,myAppointTimeSlot:e.appointConfig.myAppointTimeSlot,formParams:e.formParams},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleTimeChange.apply(void 0,arguments)},"date-change":function(t){arguments[0]=t=e.$handleEvent(t),e.handleDateChange.apply(void 0,arguments)},ready:function(t){arguments[0]=t=e.$handleEvent(t),e.handleComponentReady.apply(void 0,arguments)},"overnight-change":function(t){arguments[0]=t=e.$handleEvent(t),e.handleOvernightChange.apply(void 0,arguments)},"overnight-submit":function(t){arguments[0]=t=e.$handleEvent(t),e.handleOvernightSubmit.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"submit-btn-container"},[i("v-uni-button",{staticClass:"submit-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSubmitReservation.apply(void 0,arguments)}}},[e._v("提交预约")])],1)],1)},a=[]}}]);